import numpy as np
import matplotlib.pyplot as plt

Rsteps = '3 2.97 2.94 2.91 2.88 2.85 2.82 2.79 2.76 2.73 2.7 2.67 2.64 2.61 2.58 2.55 2.52 2.49 2.46 2.43 2.4 2.37 2.34 2.31 2.28 2.25 2.22 2.19 2.16 2.13 2.1 2.07 2.04 2.01 1.98 1.95 1.92 1.89 1.86 1.83 1.8 1.77 1.74 1.71 1.68 1.65 1.62 1.59 1.56 1.53 1.5 1.47 1.44 1.41 1.38 1.35 1.32 1.29 1.26 1.23 1.2 1.17 1.14 1.11 1.08 1.05 1.02 0.99 0.96 0.93 0.9 0.87 0.84 0.81 0.78 0.75 0.72 0.69 0.66 0.63 0.6 0.57 0.54 0.51 0.48 0.45 0.42 0.39 0.36 0.33 0.3 0.27 0.24 0.21 0.18 0.15 0.12 0.09 0.06 0.03 1e-006 '
Vsteps = '0 -0.00145488 -0.00154612 -0.00164409 -0.00174938 -0.0018626 -0.00198445 -0.00211569 -0.00225716 -0.00240976 -0.00257451 -0.00275253 -0.00294504 -0.00315341 -0.00337914 -0.0036239 -0.00388953 -0.00417809 -0.00449185 -0.00483335 -0.0052054 -0.00561115 -0.00605412 -0.00653823 -0.00706787 -0.00764794 -0.00828398 -0.00898216 -0.00974945 -0.0105937 -0.0115237 -0.0125494 -0.013682 -0.0149344 -0.0163208 -0.0178575 -0.019563 -0.0214583 -0.0235671 -0.0259163 -0.0285368 -0.0314631 -0.0347349 -0.0383969 -0.0424996 -0.0471002 -0.0522628 -0.0580592 -0.0645689 -0.0718791 -0.0800841 -0.0892833 -0.0995775 -0.111063 -0.123823 -0.137906 -0.153305 -0.169912 -0.187453 -0.205387 -0.222741 -0.237864 -0.248027 -0.2488 -0.233056 -0.189378 -0.0994782 0.0660208 0.35456 0.843318 1.65903 3.01212 5.25647 8.99589 15.2776 25.9506 44.346 76.5977 134.278 239.814 437.96 821.005 1586.25 3172.84 6603.3 14382.3 33007.9 80481.1 210583 598786 1.8803e+006 6.65988e+006 2.73768e+007 1.35935e+008 8.64401e+008 7.70726e+009 1.12156e+011 3.5407e+012 4.59394e+014 1.88168e+018 1e+072 '
Rsteps = np.array([float(a) for a in Rsteps.split()])
Vsteps = np.array([float(a) for a in Vsteps.split()])
Nsteps = Rsteps.shape[0]

r = np.arange(1e-6,3.0,0.001)
V = 1/r**12.0 - 1/r**6.0

Vdisc = V.copy()
for i in range(len(r)):
    idx = np.argmin(Rsteps>r[i])
    Vdisc[i] = Vsteps[idx]
    
plt.plot(r,V,'k',label='Continuous')
plt.plot(r,Vdisc,'r',label='Discrete')
plt.ylim([1.1*V.min(),-10*V.min()])
plt.xlim([r[np.argmin(V>-10*V.min())]-0.1,0.1+r.max()])
plt.xlabel('r')
plt.ylabel('V(r)')
plt.title('LJcut3.0, Nsteps=%d'%Nsteps)
plt.savefig('LJcut3.0_Nsteps_%d.png'%Nsteps)
plt.legend()
plt.show()
